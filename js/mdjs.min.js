(function(){function a(a,b){!String.prototype[a]&&(String.prototype[a]=b);}a('trim',function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,'');}),a('startsWith',function(a,b){return b=b||0,this.substr(b,a.length)===a;}),a('endsWith',function(a,b){var c=this.toString();(typeof b!=='number'||!isFinite(b)||Math.floor(b)!==b||b>c.length)&&(b=c.length),b-=a.length;var d=c.lastIndexOf(a,b);return d!==-1&&d===b;});})();
(function(){function a(a){var a=a.replace(/&/g,'&gt;');return a.replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/ /g,'&nbsp;').replace(/\'/g,'&#39;').replace(/\"/g,'&quot;').replace(/\n/g,'</br>');}function b(a){var b={},c=[];this.set=function(d,e,f){f&&(e.id=c.push(e),e.url=a.func.footNoteName(e.id)),b[d.toLowerCase()]=e;},this.get=function(a){return b[a.toLowerCase()];},this.getFootNoteList=function(){return c;};}function c(){var a=[],b=[],c=0;this.topLevel=function(){return c?a[c-1]:-1;},this.topType=function(){return c?b[c-1]:-1;},this.push=function(d,e){a.push(d),b.push(e),c++;},this.pop=function(){a.pop(),b.pop(),c=a.length;};}function d(){this.tag={hr:'<hr />',br:'<br />',p:['<p>','</p>'],quote:['<blockquote>','</blockquote>'],del:['<del>','</del>'],strong:['<strong>','</strong>'],em:['<em>','</em>'],inlineCode:['<code>','</code>'],codeBlock:['<pre><code data-lang="$language">','</code></pre>'],list:['<ul>','</ul>'],orderList:['<ol>','</ol>'],listItem:['<li>','</li>'],toc:['<div class="md_toc">','</div>'],tocList:['<ol>','</ol>'],tocItem:['<a href="#$uri"><li>','</li></a>'],footNote:['<div class="md_foot"><ol>','</ol></div>']},this.func={heading:function(a,b,c){return'<h'+a+' id="'+b+'" name="'+b+'">'+c+'</h'+a+'>';},link:function(b,c,d){return'<a title="'+a(c)+'" href="'+encodeURI(b)+'">'+d+'</a>';},email:function(a){return'<a href="mailto:'+a+'">'+a+'</a>';},image:function(b,c,d){return'<img alt="'+a(d)+'" title="'+a(c)+'" src="'+encodeURI(b)+'" />';},table:function(a,b){return'<table class="md_table"><thead>'+a+'</thead><tbody>'+b+'</tbody></table>';},tableRow:function(a,b,c){for(var d='<tr>',e=a?'<th style="text-align: {0}">':'<td style="text-align: {0}">',f=a?'</th>':'</td>',g=['left','center','right'],h=0;h<b.length;h++)d+=e.replace('{0}',g[c[h]])+b[h]+f;return d+'</tr>';},footNoteLink:function(b,c,d){return'<sup><a title="'+a(c)+'" href="#'+encodeURI(b)+'">'+d+'</a></sup>';},footNote:function(a,b){return'<li name="'+a+'" id="'+a+'">'+b+'</li>';},footNoteName:function(a){return'markdown_foot_'+a;}};var b=[];this.addRefLinkProvider=function(a){return b.push(a);},this._resolveRefLink=function(a){for(var c,d=0;d<b.length;d++)if(c=b[d](a))return c.url?c:{url:c};};}function e(e){function s(a){a=a.trim();var b={url:a,title:''},c=a.match(/(.+?)\s+(.+)/);if(!c)return b;b.url=c[1];var d=c[2],e=d[0],f=d[d.length-1];return d.length>=2&&((e=='\''||e=='"')&&e==f||e=='('&&f==')')&&(d=d.slice(1,-1)),b.title=d,b;}function r(a){var b=a[0];if(b!='='&&b!='-'&&b!='_'&&b!='*')return!1;for(var c=0,d=0;c<a.length;c++)if(a[c]!=' '&&a[c]!='\t'){if(a[c]!=b)return!1;d++;}return d>=3;}function t(a){for(var b=0,c=0;c<a.length;c++)if(a[c]==' ')b++;else if(a[c]=='\t')b+=4;else break;return b;}function u(a){for(var b=0;b<a.length&&!(a[b]!='#');b++);return!!b&&b;}function v(a){return a.endsWith('  ');}function w(a){return a.replace(i,'_').replace(/^_/,'').replace(/_$/,'');}function x(b,c,d){for(var e='',f=b.length,g=0,h='',m='',n=0,o=[],q=[],s=-1,G=[],H=[],K=[],L=0,M=!0,N=!1,O='',P='',Q={},R=0,S=0;S<f;S++){if(h=b[S],m=h.trim(),g){if(m=='```'){g=0,e+=I.codeBlock[1];continue;}e+=(g++>1?'\n':'')+a(h);continue;}n=t(h);var i=z(m);if(i!=0){e+=A(n,i,m);continue;}if(e+=B(),m.length==0){!M&&(e+=(N?I.br:'')+I.p[1],M=!0);continue;}if(n<4){if(m.startsWith('```')){var l=m.slice(3).trim();e+=I.codeBlock[0].replace(p,l),g=1;continue;}if(R=u(m),R!=0){for(var T=m.length-1;T>R&&m[T]=='#';T--);var U=m.slice(R,T+1),V=U=F(U,0);K[L]=R,G[L]=V=V.trim().replace(j,''),H[L++]=V=w(V),e+=J.heading(R,V,U);continue;}if(m[0]=='>'&&m.length>1){for(var W=[],X=S;X<f&&(O=b[X].trim(),O.length!=0);X++){if(O[0]=='>')O=O.slice(1)+(v(b[X])?'  ':'');else if(c)break;else O=b[X];W.push(O);}e+=I.quote[0]+x(W,!0,d)+I.quote[1],S=X-1;continue;}if(r(m)){e+=I.hr;continue;}if(m=='[TOC]'){s=e.length;continue;}if((o=D(m))!=!1&&S<f-1&&(q=C(b[S+1].trim(),o.length))!=!1){for(var k=J.tableRow(!0,o,q),Y='',Z=S+2;Z<f&&(o=D(b[Z].trim()))!=!1;Z++)Y+=J.tableRow(!1,o,q);S=Z-1,e+=J.table(k,Y);continue;}}else if(S==0||b[S-1].trim().length==0){e+=I.codeBlock[0].replace(p,'');for(var $,_='',aa=S,Z=S;Z<f;Z++){if(b[Z].trim().length==0){_+='\n';continue;}if(($=t(b[Z]))<4)break;e+=_+(Z==S?'':'\n')+E($-2)+a(b[Z].trim()),_='',aa=Z;}e+=I.codeBlock[1],S=aa;continue;}if(S+1<f){var ba=b[S+1].trim();if(r(ba)){var ca=3;ba[0]=='='?ca=1:ba[0]=='-'&&(ca=2);var V=U=F(m,0);K[L]=ca,G[L]=V=V.trim().replace(j,''),H[L++]=V=w(V),e+=J.heading(ca,V,U),S++;continue;}}Q={},O=F(h,0,Q),P=O.trim(),M&&Q.onlyOneImg?e+=O:(M&&(O=I.p[0]+O,N=!1),(d.alwaysNewline&&!M||N)&&(e+=I.br),N=v(h),e+=O,M=!1);}return!M&&(e+=(N?I.br:'')+I.p[1],M=!0),s!=-1&&(e=e.slice(0,s)+y(G,H,K,L)+e.slice(s)),e;}function y(a,b,c){for(var d,e,f=I.toc[0],g=[],h=0;h<a.length;h++)e=I.tocItem[0].replace('$uri',b[h])+a[h]+I.tocItem[1],g.length==0||c[h]>d?(f+=I.tocList[0]+e,g.push(d=c[h])):c[h]==d?f+=e:(f+=I.tocList[1],g.pop(),d=g[g.length-1],h--);for(;g.length;)f+=I.tocList[1],g.pop();return f+I.toc[1];}function z(a){return r(a)?0:a.search(h)==-1?a.search(g)==-1?0:2:1;}function A(a,b,c){var d=L.topLevel(),e=I.listItem[0]+F(c,c.indexOf(' '))+I.listItem[1],f='';if(a>d)return L.push(a,b),(b==1?I.orderList:I.list)[0]+e;if(a==d)return e;for(;a<d;)f+=L.topType()==1?I.orderList[1]:I.list[1],L.pop(),d=L.topLevel();return d==-1?(L.push(a,b),f+(b==1?I.orderList:I.list)[0]+e):f+e;}function B(){for(var a='';L.topLevel()!=-1;)a+=L.topType()==1?I.orderList[1]:I.list[1],L.pop();return a;}function C(a,b){var c=D(a,!0),d=[],e=0,f=0;if(c==!1)return!1;for(var g=c.length;e<g;e++,f=0){if(c[e].length<=1){d[e]=0;continue;}c[e][c[e].length-1]==':'&&(f=c[e][0]==':'?1:2),d[e]=f;}for(;e<b;e++)d[e]=0;return d;}function D(a,b){var c=[],d=a.length,e='';b==undefined&&(b=!1);for(var f=a[0]=='|'?1:0;f<d;f++){switch(a[f]){case'\\':if(b)return!1;e+='\\',a[f+1]=='|'&&(e+='|',f++);continue;case'|':if(e=e.trim(),b&&e.length==0)return!1;c.push(e),e='';continue;}if(!b||a[f]==':'||a[f]=='-'||a[f]==' '||a[f]=='\t')e+=a[f];else return!1;}return(c.length!=0||a[0]=='|')&&(e=e.trim(),e.length!=0&&c.push(e),c);}function E(a){return a<=0?'':q.slice(0,a);}function F(b,c,d){for(var e,g,h,m,n,o,p,q,t,u=b.length,v=[],w='',r=-1,x=-1,y=-1,z=-1,A=-1,B='*',C='*',D=0,E=c||0;E<u;E++)switch(b[E]){case'\\':f.indexOf(b[E+1])>=0&&(r=v.length,x=++E),w+=b[E];break;case'`':o=b[E+1]=='`'?'``':'`',p=o.length,(e=b.indexOf(o,E+p))==-1?w+=o:(w+=I.inlineCode[0]+a(b.slice(E+p,e))+I.inlineCode[1],E=e),E+=p-1;break;case'~':b[E+1]=='~'?(A>=0?w==''?v[A]+='~~':(v[A]+=I.del[0],w+=I.del[1],A=-1):(A=v.push(w)-1,w=''),E++):w+='~';break;case'*':case'_':if((b[E+1]==' '||b[E+1]=='\t')&&(b[E-1]==' '||b[E-1]=='\t')){w+=b[E];break;}if(b[E+1]==b[E]){if(y>=0){if(B!=b[E]){w+=b[E++]+b[E];break;}v[y]+=I.strong[0],w+=I.strong[1],y=-1;}else b[E+2]==b[E]&&b[E+3]==b[E]&&(w+=b[E++]+b[E++]),y=v.push(w)-1,w='',B=b[E];E++;}else if(z>=0){if(C!=b[E]){w+=b[E];break;}v[z]+=I.em[0],w+=I.em[1],z=-1;}else z=v.push(w)-1,w='',C=b[E];break;case'>':w+=E>=2&&b.slice(E-2,E)=='--'?'-->':'>';break;case'<':if(b.slice(E+1,E+4)=='!--'){w+='<!--';break;}for(t=1,e=E+1;e<u&&b[e]!='>';e++)(b[e]==' '||b[e]=='\t')&&(t=0);if(e>=u){w+='&lt;';break;}if(o=b.slice(E+1,e),t){if(o.match(k)){w+=J.link(o,'',o),E=e;break;}if(o.match(l)){w+=J.email(o),E=e;break;}}w+='<';break;case'!':b[E+1]!='['&&(w+='!');break;case'[':g=b[E-1]=='!'&&(r!=v.length||x!=E-1)?'i':b[E+1]=='^'?'s':'';for(var i=0,G=E+1,j=0;G<u;G++)switch(b[G]){case'!':if(b[G+1]!='[')break;g==''?(i=1,G++):G=u;break;case'`':o=b[G+1]=='`'?'``':'`',p=o.length,(e=b.indexOf(o,G+p))==-1?G+=p-1:G=e+p-1;break;case'[':G=u;break;case']':if(h=b.slice(E+1,G),g=='s'){q=K.get(h),q&&(w+=J.footNoteLink(q.url,q.title,q.id),j=1,E=G,G=u);break;}o=b[G+1];var L;if(o=='(')L=')';else if(o=='['||o==' '&&b[G+2]=='[')L=']';else{G=u;break;}if(p=o==' '?G+3:G+2,(e=b.indexOf(L,p))!=-1){if(i){i=0;break;}var M=b.slice(p,e).trim();if(L!=']')q=s(M);else if(M.length==0&&(M=h),q=K.get(M),!q&&!(q=H._resolveRefLink(M))){G=u;break;}m=q.url,n=q.title||'',g=='i'?(v.push(w),v.push(J.image(m,n,h)),w='',D++):w+=J.link(m,n,F(h,0)),j=1,E=e;}G=u;}!j&&G>=u&&(g==='s'?(w+='[^',E++):g==='i'?w+='![':w+='[');break;default:w+=b[E];}if(v.push(w),A!=-1&&(v[A]+='~~'),y!=-1&&(v[y]+=B+B),z!=-1&&(v[z]+=C),D==1){var N=0;for(var O in v)N+=v[O].trim()?1:0;N==1&&d&&(d.onlyOneImg=!0);}return v.join('');}function G(){var a=K.getFootNoteList();if(a.length==0)return'';var b=I.footNote[0];return a.forEach(function(a){return b+=J.footNote(a.url,F(a.content,0));}),b+I.footNote[1];}var H=new d();e&&(H=e);var I=H.tag,J=H.func,K=new b(H),L=new c();this.render=H,this.md2html=function(a,d){d=d||{},a=typeof a=='string'?a:String(a),K=new b(H),L=new c();for(var e=a.replace(m,'\n').split(n),f=e.length,g=[],h='',j=0;j<f;j++){h=e[j];var i=h.trim().match(o);if(!i){g.push(h);continue;}var l,p=!1,q='';if(p=i[1]=='^'){q=i[3];for(var r=j+1;r<f&&(h=e[r].trim(),!!h)&&!h.match(o);r++,j++)q+='\n'+e[r];l={title:i[2],content:q};}else l=s(i[3].trim());K.set(i[1]+i[2],l,p);}return x(g,!1,d)+G();};}var f="#`*[]()-_{}+.!|\\",g=/^[\*\-\+] +\S*/g,h=/^\d+\. +\S*/g,j=/<\/?[^<>]+>/g,i=/\W+/g,k=/^\w+:\/{2,3}\S+$/g,l=/^\S+@\S+\.\S+$/g,m=/\r\n/g,n=/[\r\n]/,o=/^\[([\^]?)(.+)\]\:\s+(.+)$/,p=/\$language/g,q=new Array(1024).join(' '),r=new e();e.md2html=function(a,b){return r.md2html(a,b);},e.escapedHTML=a,e.MdjsRenderer=d,e.Mdjs=e,typeof module=='object'&&typeof global=='object'&&(module.exports=global.Mdjs=e),typeof window!='undefined'&&(window.Mdjs=e);})();